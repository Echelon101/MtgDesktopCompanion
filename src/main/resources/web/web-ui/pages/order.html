<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>MTG Web Companion</title>
  
  <link rel="icon" type="image/png" href="../dist/img/32.png">
  <link href="//cdn.jsdelivr.net/npm/keyrune@latest/css/keyrune.css" rel="stylesheet" type="text/css" />
  <link href="//cdn.jsdelivr.net/npm/mana-font@latest/css/mana.css" rel="stylesheet" type="text/css" />

  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700" />
  <link href="//fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link id="pagestyle" href="../dist/css/material-dashboard.css?v=3.0.0" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css"/>
  <link href="//cdn.jsdelivr.net/npm/keyrune@latest/css/keyrune.css" rel="stylesheet" type="text/css" />
   <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="//unpkg.com/@trevoreyre/autocomplete-js/dist/style.css" rel="stylesheet" />
 
  <script src="//unpkg.com/@trevoreyre/autocomplete-js"></script>    

  <script src="//code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/2.10.2/umd/popper.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.perfect-scrollbar/1.5.5/perfect-scrollbar.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/smooth-scrollbar/8.7.4/smooth-scrollbar.min.js"></script>
  
  <script src="//cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
  <script src="//cdn.datatables.net/plug-ins/1.10.19/api/sum().js"></script>
  <script src="../dist/js/rest-server.js"></script>
  <script src="../dist/js/js-var.js"></script>
  <script src="../dist/js/mtgcompanion-ui.js"></script>
  <script>
	$(document).ready(function() {
			$("#sidenav-main" ).load("inc/menu.html" );
			$("#navbarBlur").load("inc/nav.html",function(){
				$("[name='categTitle']").html("Orders");
					$("#menuOrders").addClass("bg-gradient-primary");
					$("#menuOrders").addClass("active");
			});
			
			$("#navfooter").load("inc/footer.html");
			$("#settingPanel").load("inc/settingPanel.html");
			
			
			
			$.get(restserver+"/orders/list/"+$_GET('idTransaction'),function(datas){
				$("#idOrder").html(datas[0].idTransation);
				$("#sourceShop").html(datas[0].source);
				$("#dateCreation").html(datas[0].transactionDate);
				$("#typeTransaction").html(datas[0].typeTransaction);
				
				$('#transactionItems').DataTable({
		    		language: {
			    	    processing: "<img src='../dist/img/loading.gif' width='50' height='50'>"
			    	 },
			    	"data":datas,
			    	"responsive": true,
			        "processing": true,
			        "pageLength": 10,
			        "bLengthChange": false,
			        "bPaginate":false,
			        "bInfo": false, 
			        "bFilter":false,
			        "paginationType":"simple",
			      	"order": [[ 0, "desc" ]],
			        "columns": [
				        	{ 
				        	  "data": "id",
				        	  "width": "5%",
				        	  "defaultContent": "",
				        	},
				        	{ 
					        	  "data": "description",
					        	  "defaultContent": "",
					        	  "width": "40%"
					        	},
				        	{ 
				        		"data": "edition",
				        		"defaultContent": "",
					        	"width": "20%",
					            "render": function(d, type, row, meta){
							           if(type === 'display'){
							        	  try{
							        	   return '<i class="ss ss-'+d.keyRuneCode.toLowerCase()+' ss-2x"></i>'+d.set;
							        	  }
							        	  catch(error)
							        	  {
							        		  return d;
							        	  }
							            }
							            return d;
							        }
					        },
				            { 
				        		"data" : "itemPrice",
				        		"defaultContent": "",
				        		 "render": function(d, type, row, meta){
						        	   return d.toFixed(2);	
						        }
				            },
					        { 
					        		"data" : "type",
					        		"defaultContent": "",
				            }
				        ],
				        "fnDrawCallback" :function(oSettings, json) {
				        	
				        },
				        "fnInitComplete" :function(oSettings, json) {
				        	var dt = this.fnGetData();
				        	var totalProducts=dt.map(it => it.itemPrice).reduce((acc, bill) => bill + acc);
							$("#totalProducts").html(datas[0].currency+ " "+ totalProducts.toFixed(2));
							$("#shippingPriceTransaction").html(datas[0].currency+ " "+ datas[0].shippingPrice.toFixed(2))
							$("#totalTransaction").html(datas[0].currency+ " "+(totalProducts + datas[0].shippingPrice).toFixed(2));
				        }
			    } );
				
				
				
				
			});
			
			
			
	});
 </script>
</head>


<body class="g-sidenav-show  bg-gray-200">
	<aside class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start menu-left bg-gradient-dark" id="sidenav-main"></aside>
  	<main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
	<nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur" navbar-scroll="true"></nav>
   
    <div class="container-fluid py-4">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <div class="card mb-4">
            <div class="card-header p-3 pb-0">
              <div class="d-flex justify-content-between align-items-center">
                <div class="w-50">
                  <h6>Order Details</h6>
                  <p class="text-sm mb-0">
                    Order no. <b id='idOrder'> </b> from <b id="sourceShop"></b>
                  </p>
                  <p class="text-sm">
                   <span class="badge badge-sm bg-gradient-success" id="statusTransaction"></span>
                  </p>
                </div>
              </div>
            </div>
            <div class="card-body p-3 pt-0">
              <hr class="horizontal dark mt-0 mb-4">
             
               
              <div class="row">
                <div class="col-lg-12 col-md-6 col-12">
                  
                  <table id="transactionItems" style="width:100%">
	                  <thead>
	                  	<tr>
	                  		<th>ID</th>
	                  		<th>Product</th>
	                  		<th>Edition</th>
	                  		<th>Price</th>
							<th>Type</th>
	                  	</tr>
	                  </thead>
                  </table>
                  
                  
                </div>
              </div>
              
                                    
              
              <hr class="horizontal dark mt-4 mb-4">
              <div class="row">
                <div class="col-lg-3 col-md-6 col-12">
                  <h6 class="mb-3">Track order</h6>
                  <div class="timeline timeline-one-side">
                    <div class="timeline-block mb-3">
                      <span class="timeline-step">
                        <i class="material-icons text-secondary text-lg">notifications</i>
                      </span>
                      <div class="timeline-content">
                        <h6 class="text-dark text-sm font-weight-bold mb-0">Order received</h6>
                        <p class="text-secondary font-weight-normal text-xs mt-1 mb-0" id="dateCreation"></p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-5 col-md-6 col-12">
                 
                </div>
                <div class="col-lg-3 col-12 ms-auto">
                  <h6 class="mb-3">Order Summary</h6>
                  <div class="d-flex justify-content-between">
                    <span class="mb-2 text-sm">
                      Product Price:
                    </span>
                    <span class="text-dark font-weight-bold"  id="totalProducts"> </span>
                  </div>
                  <div class="d-flex justify-content-between">
                    <span class="mb-2 text-sm">
                      Delivery:
                    </span>
                    <span class="text-dark font-weight-bold" id="shippingPriceTransaction"> </span>
                  </div>
                  <div class="d-flex justify-content-between mt-4">
                    <span class="mb-2 text-lg">
                      Total ( <span id="typeTransaction"></span>): 
                    </span>
                    <span class="text-dark text-lg font-weight-bold"  id="totalTransaction"> </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

  </main>
  <div class="fixed-plugin">
    <a class="fixed-plugin-button text-dark position-fixed px-3 py-2">
      <i class="material-icons py-2">settings</i>
    </a>
    <div class="card shadow-lg" id="settingPanel">
      
    </div>
  </div>
 
  
   <script src="../dist/js/material-dashboard.js?v=3.0.0"></script>

 
</body>

</html>	
	
	
	