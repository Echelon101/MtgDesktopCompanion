<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- Site meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Site Title</title>
    <!-- CSS -->
    <link href="//cdn.jsdelivr.net/npm/jquery-ui-dist@latest/jquery-ui.min.css" rel="stylesheet">
    
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <!-- JS -->
	<script src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
 	<script src="//cdn.jsdelivr.net/npm/jquery-autocomplete@latest/jquery.autocomplete.min.js"></script>
  	<script src="//cdn.jsdelivr.net/npm/jquery-ui-dist@latest/jquery-ui.min.js"></script>
 
<script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" type="text/javascript"></script>
	
	
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" type="text/javascript"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" type="text/css">



    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" type="text/css">
	<link href="//cdn.jsdelivr.net/npm/keyrune@latest/css/keyrune.css" rel="stylesheet" type="text/css" />
    <link href="//cdn.jsdelivr.net/npm/mana-font@latest/css/mana.css" rel="stylesheet" type="text/css" />
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
 

    <script src="../dist/js/rest-server.js"></script>
   	<script src="js/js-var.js"></script>
   	<script src="js/cart.js"></script>
 
    <script>
		
    $(document).ready(function() {	
    	
	   	 $("#footer").load("footer.html");
	   	 $("#header").load("nav.html");
	   	 $("#banner").load("banner.html");

    		var collection;
    		var maxLastProduct=4;
    		var currency = "";
		   	$.ajax({
			        url: restserver+"/webshop/config"
			    }).then(function(data) {
			    	$('#siteTitle').html(data.siteTitle);
			    	$('#bannerTitle').html(data.bannerTitle);
			       	$('#bannerText').html(data.bannerText);
			       	$('#aboutText').html(data.aboutText);
			       	document.title = data.siteTitle;
			       	currency = data.currencySymbol;
			       	maxLastProduct=data.maxLastProduct;
			       	
			    	$('#contactName').html(data.contact.name + " " + data.contact.lastName);
			    	$('#contactEmail').html("<a href='mailto:"+data.contact.email+"'>"+data.contact.email+"</a>");
			    	$('#contactTelephone').html(data.contact.telephone);
			    	$('#contactWebsite').html(data.contact.website);
			    	$('#contactAddress').html(data.contact.address);
			    	$('#contactCountry').html(data.contact.country);
			       	
			    	$("#topProductImage").attr('src',"https://api.scryfall.com/cards/"+data.topProduct.scryfallId+"?format=image");
			    	$("#topProductTitle").append(data.topProduct.name);
			    	
			       	jQuery.each(data.slidesLinksImage, function(index, value) {
			       		$('#carousel-indicators').append("<li data-target='#carouselExampleIndicators' data-slide-to='"+index+"'></li>");
			       		$('#carousel-inner').append("<div class='carousel-item " + (index==0 ? "active":"")+"'><img class='d-block w-100' src='"+value+"' alt='Slide"+index+"'/></div>");
			       	});
			       	
			       	
			       	$.each( data.collections, function( key, value ) {
			    		  
			    		  $.ajax({
						        url: restserver+"/stock/list/"+value.name
						    }).then(function(data) {
						 		
						    	data=data.reverse();
						    	for(let i=0;i<maxLastProduct;i++)
					    		{
					    			$('#latest-product').append(generateStockCardHTML(data[i],currency));
					    			
					    		}

						    	$('button[name="addCartButton"]').each(function() {
						       		$(this).click(function() {
						    			addCartStockId($(this).attr("data"));
						    		});
						    	});
						    });
			    	});
			       	
			       	$.each( data.needcollections, function( key, value ) {
			    		  
			    		  $.ajax({
						        url: restserver+"/editions/list/"+value.name
						    }).then(function(data) {
						 		
						    	for(let i=0;i<data.length;i++)
					    		{
					    			$('#need-product').append(generateEditionHTML(data[i]));
					    			
					    		}

						    	
						    });
			    	});
			       	
			       	
			  });
		 });
   	 
    
    </script>
    
    
</head>
<body>

<nav id="header" class="navbar navbar-expand-md navbar-dark bg-dark"></nav>
<section id="banner" class="jumbotron text-center"></section>


<div class="container">
    <div class="row">
        <div class="col">
            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                <ol id= "carousel-indicators" class="carousel-indicators"></ol>
                
                
                <div class="carousel-inner" id="carousel-inner">
                    
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
        <div class="col-12 col-md-3">
            <div class="card">
                <div class="card-header bg-success text-white text-uppercase">
                    <i class="fa fa-heart"></i> Top product
                </div>
                <img id="topProductImage" class="img-fluid border-0" src="" alt="Card image cap">
                <div class="card-body">
                    <h4 class="card-title text-center"><a href="product.html" title="View Product"><span id="topProductTitle"/></a></h4>
                    <div class="row">
                       <!--  <div class="col">
                            <p class="btn btn-danger btn-block">99.00 $</p>
                        </div>
                        <div class="col">
                            <a href="product.html" class="btn btn-success btn-block">View</a>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container mt-3">
    <div class="row">
        <div class="col-sm">
            <div class="card">
                <div class="card-header bg-primary text-white text-uppercase">
                    <i class="fa fa-star"></i> Last products
                </div>
                <div class="card-body">
                    <div id="latest-product" class="row">
 
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container mt-3 mb-4">
    <div class="row">
        <div class="col">
            <div class="card" >
                <div class="card-header bg-primary text-white text-uppercase">
                    <i class="fa fa-search"></i> Searched Product
                </div>
                <div class="container">
                    	<div id="need-product">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Footer -->
<footer id="footer" class="text-light"></footer>



</body>
</html>
